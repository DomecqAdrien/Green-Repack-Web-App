<div class="container">
    <h1>Vendre un objet</h1>
    <form [formGroup]="form" (ngSubmit)=onSubmit()>

        <hr>
        <h2>Informations générales</h2>
        <div>
            <mat-form-field appearance="fill">
                <mat-label>Marque</mat-label>
                <mat-select formControlName="marque">
                    <mat-option>
                        <ngx-mat-select-search formControlName="marqueFilter" placeholderLabel="Rechercher..." 
                        noEntriesFoundLabel="Pas de marque trouvée">
                        </ngx-mat-select-search>
                    </mat-option>
                    <p *ngFor="let categorie of filteredMarques | async">
                        <mat-option value="{{ categorie }}">{{ categorie }}</mat-option>
                    </p>
                </mat-select>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="fill">
                <mat-label>Description</mat-label>
                <textarea formControlName="description" matInput></textarea>
            </mat-form-field>
        </div>
    
        
        <div>
            <mat-form-field appearance="fill">
                <mat-label>Catégorie</mat-label>
                <mat-select formControlName="categorie" (selectionChange)="selectCategory($event)">
                <p *ngFor="let categorie of categories">
                    <mat-option value="{{ categorie }}">{{ categorie }}</mat-option>
                </p>
                </mat-select>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="fill">
                <mat-label>État</mat-label>
                <mat-select  formControlName="etat">
                <p *ngFor="let etat of etats">
                    <mat-option value="{{ etat }}">{{ etat }}</mat-option>
                </p>
                </mat-select>
            </mat-form-field>
        </div>
    
        <hr>
        <h2>Caractéristiques</h2>
        <div *ngFor="let champ of champs">
            <mat-form-field appearance="fill">
                <mat-label>{{ champ.libelle }}</mat-label>
                <input formControlName="carac_{{champ.id}}" class="form-control" matInput>
            </mat-form-field>
        </div>
    
        <hr>
        <div>
            <button [disabled]="loading" class="btn btn-primary">
                <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
                Soumettre
            </button>
        </div>
    </form>
    
</div>
